name: Sync Personal Repo to Church Repo

# Only manual trigger
on:
workflow_dispatch: # allows you to trigger the workflow manually from GitHub

jobs:
sync:
runs-on: ubuntu-latest

steps:
- name: Checkout church repo
uses: actions/checkout@v3
with:
token: ${{ secrets.PERSONAL_REPO_TOKEN }}

- name: Configure Git
run: |
git config user.name "GitHub Action"
git config user.email "action@github.com"

- name: Add personal repo as remote
run: |
git remote add personal https://<Akin-og>:${{ secrets.PERSONAL_REPO_TOKEN }}@github.com/<Akin-og>/<spirit-stream-live>.git
git fetch personal

- name: Merge personal repo main into church repo
run: |
git checkout main
git merge personal/main --allow-unrelated-histories -m "Sync from personal repo"

- name: Push changes to church repo
run: |
git push origin main
